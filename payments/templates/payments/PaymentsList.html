{%extends 'base.html'%}

{%block content%}

<div class="row">
	<div class="col-12 table-responsive">
		
		<h1>Payments</h1>

		{%if request.user.is_staff%}
		<h3>User's info</h3>
		<p>Name: {{user.get_full_name}}</p>
		<p>Monthly payment: {{user.profile.monthly_payment}} {{user.profile.foreign_currency}}</p>
		<p>Country: {{user.profile.country}}</p>
		<form method="post">
			<div class="form-group">
				<h3>Make payment</h3>
				{% csrf_token %}
				{{form.as_p}}
				<button type="submit">Save changes</button>
			</div>
		</form>
		{%endif%}

		<h3>List</h3>
		<table class="table table-bordered text-center">
			<thead>
				<tr>
					<th>Date</th>
					<th>Identifier number</th>

					<th>Validate until</th>
					<th>Method</th>
					<th>Quantity</th>
					<th>Reference number</th>
					<th>Voucher</th>
					{%if request.user.is_staff%}
					<th>Realized by</th>
					{%endif%}									
				</tr>
			</thead>
			<tbody>
	{%for payment in payments%}
				<tr>
					<td>{{payment.created}}</td>
					<td>{{payment.pk}}</td>
					<td>{{payment.deadline}}</td>
					<td>{{payment.method}}</td>
					<td>${{payment.quantity}} {{user.profile.foreign_currency}}</td>
					<td>{%if payment.reference_number%}{{payment.reference_number}}{%endif%}</td>
					<td>{%if payment.voucher%}<a href="{{payment.voucher.url}}">See</a>{%endif%}</td>
					{%if request.user.is_staff%}
					<td>{{payment.author}}</td>
					{%endif%}
				</tr>

	{%empty%}
				<tr>
					<td colspan="5">Payments list empty</td>
				</tr>
	{%endfor%}
			</tbody>
		</table>
	</div>
</div>
{%endblock content%}